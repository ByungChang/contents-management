(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-469bb2e5"],{"60f1":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-card",[n("companyAdd"),n("userDetail"),n("ConfirmSnackBar"),n("v-card-title",[e._v("\r\n      기업 관리\r\n      "),n("v-spacer"),n("v-text-field",{attrs:{"append-icon":"mdi-magnify",label:"검색어입력","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),n("v-card-title",[n("v-row",{attrs:{justify:"end"}},[n("v-btn",{attrs:{dark:""},on:{click:function(t){return e.btnClick("add")}}},[e._v("기업 추가")])],1)],1),n("v-data-table",{staticClass:"font-weight-bold",attrs:{search:e.search,headers:e.headers,items:e.companies,"hide-default-footer":"","items-per-page":3,page:e.page},on:{"update:page":function(t){e.page=t},"page-count":function(t){e.pageCount=t}},scopedSlots:e._u([{key:"item.img",fn:function(t){t.item;return[e.x>600?n("v-avatar",{staticClass:"ma-3",attrs:{size:"100"}},[n("v-img",{attrs:{src:a("dbfb")}})],1):n("v-avatar",{attrs:{size:"40"}},[n("v-img",{attrs:{src:a("dbfb")}})],1)]}},{key:"item.name",fn:function(t){var a=t.item;return[n("v-list-item",{staticStyle:{"text-align":"left"},on:{click:function(t){return e.companyDetail(a)}}},[e._v(e._s(a.name))])]}},{key:"item.state",fn:function(t){var a=t.item;return[n("v-btn",{attrs:{color:e.getColor(a.state)},on:{click:function(t){return e.statusChange(a)}}},[e._v(e._s(a.state))])]}},{key:"item.action",fn:function(t){var a=t.item;return[n("v-btn",{attrs:{icon:""},on:{click:function(t){return e.userDetail(a)}}},[n("v-icon",[e._v("mdi-information-outline")])],1),n("v-btn",{attrs:{icon:""},on:{click:function(t){e.btnClick("edit"),e.editTable(a)}}},[n("v-icon",[e._v("mdi-square-edit-outline")])],1),n("v-btn",{attrs:{icon:""},on:{click:function(t){return e.deleteCompany(a)}}},[n("v-icon",[e._v("mdi-trash-can-outline")])],1)]}}])}),n("div",{staticClass:"text-center"},[n("v-pagination",{attrs:{length:e.pageCount,circle:""},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1)],1),n("foot")],1)},i=[],c=(a("ac6a"),a("2b0e")),s=a("c1df"),o=a.n(s),r=a("b047"),l=a.n(r),d=a("bc3a"),u=a.n(d),m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-form",{ref:"form",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-dialog",{attrs:{scrollable:"","max-width":"600px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("AlertSnackBar"),a("v-card",[a("v-app-bar",{attrs:{dark:"",color:"#2a3248"}},[a("v-card-title",[a("span",[e._v(e._s(e.formTitle))])]),a("v-spacer"),a("v-btn",{attrs:{icon:"",dark:""}},[a("v-icon",{attrs:{size:"30px"},on:{click:e.modalClose}},[e._v("mdi-close")])],1)],1),a("v-card-text",[a("v-divider"),a("v-col",{attrs:{cols:"12"}},[a("v-text-field",{attrs:{counter:20,rules:e.nameRules,label:"기업명*","prepend-inner-icon":"mdi-account-check",required:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),a("v-col",{attrs:{cols:"12"}},[a("v-select",{attrs:{items:e.actitems,label:"활성화 여부*","prepend-inner-icon":"mdi-lock"},model:{value:e.state,callback:function(t){e.state=t},expression:"state"}})],1),a("v-col",{attrs:{cols:"12"}},[a("v-text-field",{attrs:{counter:20,rules:e.emailRules,label:"이메일*","prepend-inner-icon":"mdi-email",required:""},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1),a("companyHvSelect"),a("v-col",{attrs:{cols:"12"}},[a("v-text-field",{attrs:{counter:20,rules:e.businessRules,label:"사업자번호*","prepend-inner-icon":"mdi-domain",required:""},model:{value:e.business,callback:function(t){e.business=t},expression:"business"}})],1),a("v-col",{attrs:{cols:"12"}},[a("v-menu",{attrs:{"close-on-content-click":!1,"nudge-right":10,transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-text-field",e._g({attrs:{label:"만료일",rules:e.dateRules,readonly:e.readonly,"prepend-inner-icon":"mdi-calendar"},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}},n))]}}]),model:{value:e.menu,callback:function(t){e.menu=t},expression:"menu"}},[a("v-date-picker",{attrs:{locale:"ko"},on:{input:function(t){e.menu=!1}},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})],1)],1),a("v-col",{attrs:{cols:"12"}},[a("v-file-input",{attrs:{rules:e.imgRules,accept:"image/png, image/jpeg, image/bmp",placeholder:"사진 추가","prepend-inner-icon":"mdi-camera","prepend-icon":"",label:"사진"},model:{value:e.picture,callback:function(t){e.picture=t},expression:"picture"}})],1),a("v-spacer")],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{disabled:!e.valid,color:"success"},on:{click:e.saveClick}},[e._v("\n          저장\n        ")]),a("v-btn",{attrs:{color:"error"},on:{click:e.modalClose}},[e._v("\n          닫기\n        ")])],1)],1)],1)],1)},p=[],v=(a("7f7f"),a("a27f")),f=a("12a2"),h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-col",{attrs:{cols:"12"}},[a("v-dialog",{attrs:{scrollable:"","max-width":"400px"},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-text-field",e._g({attrs:{label:"하이퍼비전","prepend-inner-icon":"mdi-plus"},model:{value:e.hvText,callback:function(t){e.hvText=t},expression:"hvText"}},n))]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("div",e._l(e.selected,(function(t){return a("v-chip",{key:t.name,attrs:{close:""},on:{"click:close":function(a){return e.remove(t)}}},[e._v("\n          "+e._s(t.name)+"\n        ")])})),1),a("v-card-title",{staticClass:"font-weight-bold"},[e._v("\n        하이퍼비전 리스트\n        "),a("v-spacer"),a("v-text-field",{attrs:{"append-icon":"mdi-heart",label:"하이퍼비전 검색","single-line":"","hide-details":""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),a("v-data-table",{staticClass:"font-weight-bold",attrs:{"items-per-page":e.perpage=5,search:e.search,headers:e.headers,items:e.items,"show-select":"","item-key":"name"},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}}),a("v-btn",{attrs:{dark:""},on:{click:e.hvSelect}},[e._v("선택완료")])],1)],1)],1)},b=[],g={data:function(){return{dialog:!1,hvText:"",selected:[],search:"",pageCount:0,page:1,headers:[{text:"하이퍼 비전",align:"start",sortable:!0,value:"name"}],items:[]}},created:function(){var e=this;u.a.get("/api/company/device",{}).then((function(t){e.items=t.data.device})).catch((function(e){console.error(e.message)})),v["a"].$on("comHVList",(function(t){e.selected=t})),v["a"].$on("HyperVisonClean",(function(t){e.hvText="",e.selected=[]}))},methods:{remove:function(e){this.selected.splice(this.selected.indexOf(e),1)},hvSelect:function(){this.dialog=!1,v["a"].$emit("select",this.selected),this.selected.length>=1?this.hvText=this.selected[0].name+"등("+this.selected.length+")개 선택됨":this.hvText="*선택된 하이퍼비전이 없습니다.*"}}},x=g,k=(a("a892"),a("2877")),y=a("6544"),V=a.n(y),C=a("8336"),_=a("b0af"),I=a("99d9"),D=a("cc20"),$=a("62ad"),T=a("8fea"),S=a("169a"),w=a("2fa4"),A=a("8654"),R=Object(k["a"])(x,h,b,!1,null,null,null),E=R.exports;V()(R,{VBtn:C["a"],VCard:_["a"],VCardTitle:I["c"],VChip:D["a"],VCol:$["a"],VDataTable:T["a"],VDialog:S["a"],VSpacer:w["a"],VTextField:A["a"]});var Y={components:{AlertSnackBar:f["a"],companyHvSelect:E},data:function(){return{companyId:0,mode:"",device:[],readonly:!0,formTitle:"",select:[],menu:!1,dialog:!1,valid:!0,state:"",picture:null,name:"",email:"",date:"",business:"",nameRules:[function(e){return!!e||"기업명을 입력해주세요"},function(e){return e&&e.length<=20||"20글자 초과 하실 수 없습니다."}],emailRules:[function(e){return!!e||"E-mail을 입력해주세요"},function(e){return/.+@.+\..+/.test(e)||"잘못된 형식의 이메일 입니다"},function(e){return e&&e.length<=20||"20글자 초과 하실 수 없습니다."}],imgRules:[function(e){return!e||e.size<2e6||"Avatar size should be less than 2 MB!"}],dateRules:[function(e){return!!e||"만료일을 입력해주세요"}],businessRules:[function(e){return!!e||"사업자번호를 입력해주세요"},function(e){return e&&e.length<=20||"20글자 초과 하실 수 없습니다."}],actitems:["active","block"]}},created:function(){var e=this;v["a"].$on("companyAdd",(function(t){e.mode="post","add"===t&&(e.formTitle="기업 추가"),"edit"===t&&(e.formTitle="기업 정보 수정"),e.dialog=!0})),v["a"].$on("comEditInfo",(function(t){e.mode="put",u.a.post("/api/company/edit",{branchId:t.id}).then((function(t){console.log(t.data),e.name=t.data.branch.name,e.companyId=t.data.branch.companyId,e.date=e.$moment(t.data.branch.expiredDate).format("YYYY-MM-DD"),e.state=t.data.branch.user_groups[0].users[0].userYn,e.email=t.data.branch.user_groups[0].users[0].orgId,e.business=t.data.branch.busNumber})),u.a.post("/api/company/editDevice",{branchId:t.id}).then((function(e){v["a"].$emit("comHVList",e.data.result)}))})),v["a"].$on("select",(function(t){e.select=t}))},methods:{saveClick:function(){"post"===this.mode?(u.a.post("/api/company",{name:this.name,busNumber:this.business,address:this.address,tel:this.tel,expiredDate:this.date,devices:this.select,email:this.email,state:this.state}).catch((function(e){console.error(e.message)})),v["a"].$emit("SaveItem","company")):"put"===this.mode&&u.a.put("/api/company",{companyId:this.companyId,name:this.name,busNumber:this.business,address:this.address,tel:this.tel,expiredDate:this.date,devices:this.select}).then((function(e){v["a"].$emit("EditItem","company")})).catch((function(e){console.error(e.message)}))},modalClose:function(){this.dialog=!1,this.$refs.form.resetValidation(),this.state="",this.picture=null,this.name="",this.email="",this.date="",this.business="",v["a"].$emit("HyperVisonClean",!0)}}},B=Y,M=a("40dc"),j=a("2e4b"),H=a("ce7e6"),O=a("23a7"),z=a("4bd4"),N=a("132d"),F=a("e449"),P=a("b974"),q=Object(k["a"])(B,m,p,!1,null,null,null),L=q.exports;V()(q,{VAppBar:M["a"],VBtn:C["a"],VCard:_["a"],VCardActions:I["a"],VCardText:I["b"],VCardTitle:I["c"],VCol:$["a"],VDatePicker:j["a"],VDialog:S["a"],VDivider:H["a"],VFileInput:O["a"],VForm:z["a"],VIcon:N["a"],VMenu:F["a"],VSelect:P["a"],VSpacer:w["a"],VTextField:A["a"]});var J=a("6688"),W=a("b536");c["a"].use(l.a,o.a);var G={components:{companyAdd:L,userDetail:J["a"],ConfirmSnackBar:W["default"]},data:function(){return{to:{path:"/userManagement"},info:[],x:window.innerWidth,companyId:0,branchId:0,devices:[],search:"",page:1,pageCount:0,headers:[{text:"프로필사진",align:"center",value:"img",sortable:!1},{text:"회사",value:"name",align:"center"},{text:"상태",value:"state",align:"center"},{text:"유저수",value:"userNum",align:"center"},{text:"HYPER VSN",value:"hvNum",align:"center"},{text:"계약 만료일",value:"expiredDate",align:"center"},{text:"정보보기/수정/삭제",value:"action",sortable:!1,align:"center"}],companies:[],number:-1}},mounted:function(){var e=this;v["a"].$on("delCompanyOk",(function(t){e.info=[{companyId:e.companyId}],u.a.delete("/api/company",{data:{info:e.info}}).then((function(e){location.href="/company"}))}));var t=localStorage.getItem("token");u.a.get("/api/company",{headers:{Authorization:t}}).then((function(t){if(!t.data.success)return console.error(t.data.msg);console.log(t.data),t.data.companies.forEach((function(t){t.expiredDate=e.$moment(t.expiredDate).format("YYYY-MM-DD")})),e.companies=t.data.companies;var a=0;e.companies.forEach((function(t){"admin"===t.user_groups[0].groupAuth&&delete e.companies[a],a++}))})).catch((function(e){console.error(e.message)}))},methods:{companyDetail:function(e){var t=e.companyId;this.$router.push({name:"userManagement",params:{companyId:t}})},getColor:function(e){return"active"===e?"green":"red"},btnClick:function(e){v["a"].$emit("companyAdd",e)},statusChange:function(e){this.number=this.companies.indexOf(e),"active"===this.companies[this.number].state?(this.companies[this.number].state="block",u.a.put("/api/company/state",{id:e.id,state:"block",isCompany:!0}).catch((function(e){console.error(e.message)}))):"block"===this.companies[this.number].state&&(this.companies[this.number].state="active",u.a.put("/api/company/state",{id:e.id,state:"active",isCompany:!0}).catch((function(e){console.error(e.message)})))},editTable:function(e){v["a"].$emit("comEditInfo",e)},userDetail:function(e){v["a"].$emit("companyDetail",e)},deleteCompany:function(e){this.companyId=e.companyId,this.branchId=e.branchId,v["a"].$emit("DelCompany",e)}}},K=G,Q=a("8212"),U=a("adda"),X=a("da13"),Z=a("891e"),ee=a("0fd9"),te=Object(k["a"])(K,n,i,!1,null,null,null);t["default"]=te.exports;V()(te,{VAvatar:Q["a"],VBtn:C["a"],VCard:_["a"],VCardTitle:I["c"],VDataTable:T["a"],VIcon:N["a"],VImg:U["a"],VListItem:X["a"],VPagination:Z["a"],VRow:ee["a"],VSpacer:w["a"],VTextField:A["a"]})},a892:function(e,t,a){"use strict";var n=a("b467"),i=a.n(n);i.a},b047:function(e,t,a){(function(){function t(e,t){t?(e.moment=t,Object.defineProperties(e.prototype,{$moment:{get:function(){return t}}})):console.error("Please install Moment.js")}e.exports=t})()},b467:function(e,t,a){}}]);
//# sourceMappingURL=chunk-469bb2e5.149a9460.js.map